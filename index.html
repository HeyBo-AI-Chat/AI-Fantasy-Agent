<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Fantasy Agent</title>
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#0B132B" />
  <link rel="apple-touch-icon" href="/icon-192.png" />
  
</head>
<body>

<main class="wrap">
  <h2>AI Fantasy Agent</h2>

  <!-- season/week controls + compute -->
  <div class="row">
    <select id="season"></select>
    <select id="week"></select>
    <button id="btnCompute" class="btn">Compute</button>
  </div>

  <!-- LINK EXTERNAL PLATFORM FORM -->
  <div class="card">
    <h3>Link External Platform</h3>
    <div class="row">
      <select id="srcPlatform">
        <option value="" disabled selected>Select Platform</option>
        <option value="DraftKings">DraftKings</option>
        <option value="FanDuel">FanDuel</option>
        <option value="Yahoo">Yahoo</option>
        <option value="ESPN">ESPN</option>
        <option value="Sleeper">Sleeper</option>
        <option value="Other">Other</option>
      </select>
      <input id="srcHandle" placeholder="Username / League ID" />
    </div>
    <div class="row">
      <textarea id="srcNotes" placeholder="Notes (optional)"></textarea>
    </div>
    <div class="row spread">
      <span id="srcStatus" class="badge"></span>
      <button id="btnAddSource" class="btn">Add Source</button>
    </div>
  </div>

  <!-- LIST OF SAVED SOURCES -->
  <div class="card">
    <h3>Linked Sources</h3>
    <div id="sourcesList">
      <!-- Sources will be dynamically added here -->
    </div>
    <button id="btnReloadSources" class="btn muted">Reload</button>
  </div>

  <!-- ========= TAB PANELS ========= -->

  <!-- DRAFT -->
  <section id="tab-draft">
    <div class="row spread">
      <h3>Draft</h3>
      <span id="draftCount" class="badge">0 players</span>
    </div>
    <div id="draftList" class="card">
      <!-- Draft list will be dynamically added here -->
    </div>
  </section>

  <!-- ROSTER -->
  <section id="tab-roster" class="hidden">
    <div class="row spread">
      <h3>Roster</h3>
      <span id="rosterCount" class="badge">0 players</span>
    </div>
    <div id="rosterList" class="card">
        <!-- Roster list will be dynamically added here -->
    </div>
  </section>

  <!-- LINEUP -->
  <section id="tab-lineup" class="hidden">
    <div class="row spread">
      <h3>Lineup</h3>
      <button id="btnSaveLineup" class="btn">Save Lineup</button>
    </div>
    <div class="card">
      <h4>Starters</h4>
      <div id="starters">
        <!-- Starters will be dynamically added here -->
      </div>
    </div>
    <div class="card">
      <h4>Bench</h4>
      <div id="bench">
        <!-- Bench players will be dynamically added here -->
      </div>
    </div>
  </section>

  <!-- SCORES -->
  <section id="tab-scores" class="hidden">
    <div class="row spread">
      <h3>Scores</h3>
      <span id="scoresUpdated" class="badge">â€”</span>
    </div>
    <div class="card">
      <div class="row spread">
        <b>Team total</b>
        <b id="teamTotal">0.0</b>
      </div>
    </div>
    <div id="scoresList">
      <!-- Scores will be dynamically added here -->
    </div>
  </section>

  <!-- NEWS -->
  <section id="tab-news" class="hidden">
    <div class="row spread">
      <h3>News & Injuries</h3>
      <button id="btnRefreshNews" class="btn muted">Refresh</button>
    </div>
    <div id="newsList" class="card">
      <!-- News items will be dynamically added here -->
    </div>
  </section>

  <!-- AGENT -->
  <section id="tab-agent" class="hidden">
    <div class="row spread">
      <h3>Agent</h3>
      <div class="row">
        <button id="btnTTS" class="btn muted" title="Toggle speech output">ðŸ”ˆ Speak: Off</button>
        <button id="btnMic" class="btn" title="Hold to talk">ðŸŽ¤ Hold</button>
      </div>
    </div>
    <textarea id="agentInput" class="input" placeholder="Ask Agentâ€¦ e.g. Start/Sit for Week 3"></textarea>
    <div class="card">
      <div id="voiceStatus" class="badge">Mic idle</div>
    </div>
    <div id="agentReply" class="card">
      <!-- Agent's reply will appear here -->
    </div>
  </section>

</main>

<!-- BOTTOM NAVIGATION -->
<nav id="tabs">
  <button type="button" class="tabbtn active" data-t="draft">Draft</button>
  <button type="button" class="tabbtn" data-t="roster">Roster</button>
  <button type="button" class="tabbtn" data-t="lineup">Lineup</button>
  <button type="button" class="tabbtn" data-t="scores">Scores</button>
  <button type="button" class="tabbtn" data-t="news">News</button>
  <button type="button" class="tabbtn" data-t="agent">Agent</button>
</nav>

<!-- SCRIPTS -->
<script src="./config.js" defer></script>
<script src="./app.js" defer></script>
<script>
  // Initialize Service Worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker
        .register('/sw.js', { scope: '/' })
        .then(r => console.log('Service Worker registered with scope:', r.scope))
        .catch(err => console.warn('Service Worker registration failed:', err));
    });
  }

  // Remove any leftover demo/placeholder player rows if needed
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.player-row-demo').forEach(el => el.remove());
  });
<script src="./config.js?v=3" defer></script>
<script src="./app.js?v=4" defer></script>

</body>
</html>
